{{define "courses"}}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Courses - WMU Course Scheduler</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
        .content { margin: 24px; }
        
        /* Table container with scrollbars */
        .table-container {
            border: 2px solid #ddd;
            border-radius: 8px;
            overflow: auto;
            max-height: 420px; /* Approximately 10 rows (42px per row) */
            margin-bottom: 24px;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        table { 
            width: 100%; 
            border-collapse: collapse; 
            margin: 0;
            min-width: 1400px; /* Ensures horizontal scrollbar when needed */
        }
        
        th, td { 
            border: 1px solid #ccc; 
            padding: 8px; 
            text-align: left;
            white-space: nowrap; /* Prevents text wrapping */
            vertical-align: top;
        }
        
        th { 
            background-color: #8B4513;
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
            border-bottom: 2px solid #654321;
            font-weight: bold;
            font-size: 14px;
        }
        
        /* Column widths */
        th:nth-child(1), td:nth-child(1) { width: 80px; } /* CRN */
        th:nth-child(2), td:nth-child(2) { width: 60px; } /* Section */
        th:nth-child(3), td:nth-child(3) { width: 60px; } /* Prefix */
        th:nth-child(4), td:nth-child(4) { width: 80px; } /* Course # */
        th:nth-child(5), td:nth-child(5) { width: 200px; white-space: normal; } /* Title */
        th:nth-child(6), td:nth-child(6) { width: 60px; } /* Credits */
        th:nth-child(7), td:nth-child(7) { width: 60px; } /* Contact */
        th:nth-child(8), td:nth-child(8) { width: 60px; } /* Cap */
        th:nth-child(9), td:nth-child(9) { width: 50px; } /* Appr */
        th:nth-child(10), td:nth-child(10) { width: 50px; } /* Lab */
        th:nth-child(11), td:nth-child(11) { width: 150px; } /* Instructor */
        th:nth-child(12), td:nth-child(12) { width: 120px; } /* Time */
        th:nth-child(13), td:nth-child(13) { width: 100px; } /* Room */
        th:nth-child(14), td:nth-child(14) { width: 80px; } /* Mode */
        th:nth-child(15), td:nth-child(15) { width: 100px; } /* Status */
        th:nth-child(16), td:nth-child(16) { width: 150px; white-space: normal; } /* Comment */
        
        /* Zebra striping for better readability */
        tbody tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        tbody tr:hover {
            background-color: #e8f4f8;
        }
        
        /* Dropdown styling */
        select {
            width: 100%;
            padding: 4px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 12px;
        }
        
        /* Checkbox styling */
        input[type="checkbox"] {
            transform: scale(1.2);
        }
        
        /* Comment input styling */
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 4px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 12px;
        }
        
        /* Specific input field styling */
        .crn-input { width: 70px; }
        .section-input { width: 50px; }
        .course-number-input { width: 70px; }
        .title-input { width: 190px; }
        .credits-input { width: 50px; }
        .contact-input { width: 50px; }
        .cap-input { width: 50px; }
        
        .button-row { 
            display: flex; 
            gap: 12px; 
            justify-content: flex-end; 
        }
        
        button { 
            padding: 10px 20px; 
            font-size: 14px; 
            cursor: pointer;
            border: 1px solid #8B4513;
            background-color: #8B4513;
            color: white;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #654321;
        }
        
        /* Scrollbar styling for webkit browsers */
        .table-container::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }
        
        .table-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 6px;
        }
        
        .table-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 6px;
        }
        
        .table-container::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Table info */
        .table-info {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
            text-align: right;
        }
        
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .page-header h1 {
            margin: 0;
            color: #8B4513;
        }
        
        .add-course-btn {
            background-color: #28a745;
            border-color: #28a745;
        }
        
        .add-course-btn:hover {
            background-color: #218838;
        }
    </style>
</head>
<body>
    {{template "navbar" .}}
    <div class="content">
        <div class="page-header">
            <h1>Course Management</h1>
            <button class="add-course-btn">Add New Course</button>
        </div>
        
        <div class="table-info">
            Showing {{len .Courses}} course(s) - Scroll to see more
        </div>
        
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>CRN</th>
                        <th>Section</th>
                        <th>Prefix</th>
                        <th>Course #</th>
                        <th>Title</th>
                        <th>Credits</th>
                        <th>Contact</th>
                        <th>Cap</th>
                        <th>Approval</th>
                        <th>Lab</th>
                        <th>Instructor</th>
                        <th>Time</th>
                        <th>Room</th>
                        <th>Mode</th>
                        <th>Status</th>
                        <th>Comment</th>
                    </tr>
                </thead>
                <tbody>
                    {{range .Courses}}
                    <tr>
                        <td>
                            <input type="number" class="crn-input" value="{{.CRN}}" 
                                   onchange="updateCourse({{.ID}}, 'crn', this.value)">
                        </td>
                        <td>
                            <input type="number" class="section-input" value="{{.Section}}" 
                                   onchange="updateCourse({{.ID}}, 'section', this.value)">
                        </td>
                        <td>{{.Prefix}}</td>
                        <td>
                            <input type="number" class="course-number-input" value="{{.CourseNumber}}" 
                                   onchange="updateCourse({{.ID}}, 'course_number', this.value)">
                        </td>
                        <td>
                            <input type="text" class="title-input" value="{{.Title}}" 
                                   onchange="updateCourse({{.ID}}, 'title', this.value)">
                        </td>
                        <td>
                            <input type="number" class="credits-input" value="{{.Credits}}" 
                                   onchange="updateCourse({{.ID}}, 'credits', this.value)">
                        </td>
                        <td>
                            <input type="number" class="contact-input" value="{{.Contact}}" 
                                   onchange="updateCourse({{.ID}}, 'contact', this.value)">
                        </td>
                        <td>
                            <input type="number" class="cap-input" value="{{.Cap}}" 
                                   onchange="updateCourse({{.ID}}, 'cap', this.value)">
                        </td>
                        <td>
                            <input type="checkbox" {{if .Approval}}checked{{end}} 
                                   onchange="updateCourse({{.ID}}, 'approval', this.checked)">
                        </td>
                        <td>
                            <input type="checkbox" {{if .Lab}}checked{{end}} 
                                   onchange="updateCourse({{.ID}}, 'lab', this.checked)">
                        </td>
                        <td>
                            <select onchange="updateCourse({{.ID}}, 'instructor_id', this.value)">
                                <option value="">Select Instructor</option>
                                {{range $.Instructors}}
                                <option value="{{.ID}}" {{if eq .ID $.CurrentCourse.InstructorID}}selected{{end}}>
                                    {{.FirstName}} {{.LastName}}
                                </option>
                                {{end}}
                            </select>
                        </td>
                        <td>
                            <select onchange="updateCourse({{.ID}}, 'timeslot_id', this.value)">
                                <option value="">Select Time</option>
                                {{range $.TimeSlots}}
                                <option value="{{.ID}}" {{if eq .ID $.CurrentCourse.TimeslotID}}selected{{end}}>
                                    {{.DayOfWeek}} {{.StartTime}}-{{.EndTime}}
                                </option>
                                {{end}}
                            </select>
                        </td>
                        <td>
                            <select onchange="updateCourse({{.ID}}, 'room_id', this.value)">
                                <option value="">Select Room</option>
                                {{range $.Rooms}}
                                <option value="{{.ID}}" {{if eq .ID $.CurrentCourse.RoomID}}selected{{end}}>
                                    {{.Building}} {{.RoomNumber}}
                                </option>
                                {{end}}
                            </select>
                        </td>
                        <td>
                            <select onchange="updateCourse({{.ID}}, 'mode', this.value)">
                                <option value="IP" {{if eq .Mode "IP"}}selected{{end}}>IP</option>
                                <option value="FSO" {{if eq .Mode "FSO"}}selected{{end}}>FSO</option>
                                <option value="PSO" {{if eq .Mode "PSO"}}selected{{end}}>PSO</option>
                                <option value="H" {{if eq .Mode "H"}}selected{{end}}>H</option>
                            </select>
                        </td>
                        <td>
                            <select onchange="updateCourse({{.ID}}, 'status', this.value)">
                                <option value="Scheduled" {{if eq .Status "Scheduled"}}selected{{end}}>Scheduled</option>
                                <option value="Added" {{if eq .Status "Added"}}selected{{end}}>Added</option>
                                <option value="Removed" {{if eq .Status "Removed"}}selected{{end}}>Removed</option>
                                <option value="Updated" {{if eq .Status "Updated"}}selected{{end}}>Updated</option>
                                <option value="Deleted" {{if eq .Status "Deleted"}}selected{{end}}>Deleted</option>
                            </select>
                        </td>
                        <td>
                            <input type="text" value="{{.Comment}}" 
                                   onchange="updateCourse({{.ID}}, 'comment', this.value)"
                                   placeholder="Add comment...">
                        </td>
                    </tr>
                    {{end}}
                </tbody>
            </table>
        </div>
        
        <div class="button-row">
            <button type="button">Export Courses</button>
            <button type="button">Import Courses</button>
            <button type="button">Generate Report</button>
            <button type="button">Save Changes</button>
        </div>
    </div>
    
    <script>
        function updateCourse(courseId, field, value) {
            // This function will be used to update course data via AJAX
            console.log('Updating course', courseId, 'field', field, 'to', value);
            
            // TODO: Implement AJAX call to update course in database
            // Example:
            // fetch('/api/courses/' + courseId, {
            //     method: 'PUT',
            //     headers: {
            //         'Content-Type': 'application/json',
            //         'X-CSRF-Token': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
            //     },
            //     body: JSON.stringify({
            //         field: field,
            //         value: value
            //     })
            // })
            // .then(response => response.json())
            // .then(data => {
            //     if (data.success) {
            //         console.log('Course updated successfully');
            //     } else {
            //         console.error('Error updating course:', data.error);
            //     }
            // });
        }
    </script>
</body>
</html>
{{end}}
